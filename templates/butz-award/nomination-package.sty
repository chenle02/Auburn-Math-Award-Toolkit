% nomination-package.sty
% Shared LaTeX style for Auburn Math & Stats Faculty Award Nomination Packages
%
% Usage: \usepackage{nomination-package}
% Then define \Nominee and \Award before \begin{document}
%
% Provides:
%   \vfile{file.pdf}           -- include portrait PDF pages with footer
%   \hfile{file.pdf}{pages}    -- include landscape PDF pages (rotated) with footer
%   \hselectedfile{file.pdf}{pages} -- include selected landscape pages
%   \myPart{content}           -- centered section divider page
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{nomination-package}[2025/02/09 Auburn Math Award Nomination Package]

\RequirePackage[text={6.2in,10in},centering]{geometry}
\RequirePackage{xcolor}
\RequirePackage[
  colorlinks=true,
  linkcolor=blue!40!black,
  filecolor=magenta,
  urlcolor=cyan,
  citecolor=magenta,
  pdftitle={Nomination Package},
  pdfpagemode=FullScreen,
]{hyperref}
\RequirePackage{pdfpages}
\RequirePackage{fancyhdr}

\makeatletter

%% Helper: shift text horizontally
\newcommand*{\np@shifttext}[2]{%
  \settowidth{\@tempdima}{#2}%
  \makebox[\@tempdima]{\hspace*{#1}#2}%
}

%% Page style: portrait pages (plain)
\fancypagestyle{plain}{%
  \fancyhf{}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{1pt}%
  \rfoot{\bf\thepage}%
  \fancyfoot[C]{\bf\Nominee}%
}

%% Page style: landscape pages
\fancypagestyle{mylandscape}{%
  \fancyhf{}%
  \fancyfoot{%
    \makebox[\textwidth][r]{%
      \rlap{\hspace{\footskip}%
        \smash{%
          \np@shifttext{3em}{%
            \raisebox{\dimexpr.6\baselineskip+\footskip+.4\textheight}{%
              \rotatebox{90}{\bf\Nominee}}}%
          \raisebox{\dimexpr.0\baselineskip+\footskip+.99\textheight}{%
            \rotatebox{90}{\bf \thepage}}%
          \raisebox{.05\textheight}{%
            \np@shifttext{-3em}{\rotatebox{90}{\rule{\textheight}{0.8pt}}}}%
        }}}}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

\makeatother

%% \vfile{filename.pdf} -- include all pages of a portrait PDF
\newcommand{\vfile}[1]{%
  \includepdf[pagecommand={\thispagestyle{plain}},pages=-]{#1}%
  \thispagestyle{plain}%
}

%% \hfile{filename.pdf}{page-range} -- include landscape PDF pages (rotated 90 degrees)
\newcommand{\hfile}[2]{%
  \includepdf[pagecommand={\thispagestyle{mylandscape}},angle=90,pages=#2]{#1}%
  \thispagestyle{plain}%
}

%% \hselectedfile{filename.pdf}{page-list} -- include selected landscape pages
\newcommand{\hselectedfile}[2]{%
  \includepdf[pagecommand={\thispagestyle{mylandscape}},angle=90,pages={#2}]{#1}%
  \thispagestyle{plain}%
}

%% \myPart{content} -- vertically centered section divider
\newcommand{\myPart}[1]{%
  \vspace*{\fill}%
  \begin{minipage}{\textwidth}#1\end{minipage}%
  \vspace*{\fill}%
}

\endinput
